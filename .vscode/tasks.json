{
    "version": "2.0.0",
    "options": {
        "cwd": "${workspaceFolder}",
        "env": {
            "VIRTUAL_ENV": "${workspaceFolder}/.venv",
            "PATH": "${workspaceFolder}/.venv/bin:${env:PATH}"
        }
    },
    "tasks": [
        {
            "label": "cmake_configure",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--preset=${input:presetName}"
            ],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "detail": "CMakeでプリセットを使用してセットアップを実行"
        },
        {
            "label": "cmake_configure_legacy",
            "type": "shell",
            "command": "cmake",
            "args": [
                "-S.",
                "-Bbuild",
                "-DCMAKE_BUILD_TYPE=${input:buildType}",
                "-DPython_EXECUTABLE=${workspaceFolder}/.venv/bin/python"
            ],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "detail": "CMakeで従来方式のセットアップを実行（プリセット未対応環境用）"
        },
        {
            "label": "cmake_build",
            "type": "shell",
            "command": "cmake",
            "args": [
                "--build",
                "${workspaceFolder}/build"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "CMakeでビルドを実行",
            "dependsOn": [
                "cmake_configure"
            ]
        }
    ],
    "inputs": [
        {
            "id": "presetName",
            "description": "Select CMake preset",
            "type": "pickString",
            "options": [
                "default",
                "debug",
                "macos",
                "ubuntu",
                "rhel",
                "llvm-build",
                "ci"
            ],
            "default": "default"
        },
        {
            "id": "buildType",
            "description": "Select build type (legacy mode)",
            "type": "pickString",
            "options": [
                "Debug",
                "Release",
                "RelWithDebInfo",
                "MinSizeRel"
            ],
            "default": "Debug"
        }
    ]
}
